<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="Generator" CONTENT="MS Exchange Server version 6.5.7036.0">
<TITLE>FW: [mpich-discuss] mpiexec kills the remote login shell</TITLE>
</HEAD>
<BODY>
<!-- Converted from text/plain format -->

<P><FONT SIZE=2><BR>
<BR>
&gt; -----Original Message-----<BR>
&gt; From: Yu-Cheng Chou [<A HREF="mailto:cycchou@ucdavis.edu">mailto:cycchou@ucdavis.edu</A>]<BR>
&gt; Sent: Wednesday, February 04, 2009 2:32 PM<BR>
&gt; To: Jayesh Krishna<BR>
&gt; Cc: mpich-discuss@mcs.anl.gov<BR>
&gt; Subject: Re: [mpich-discuss] mpiexec kills the remote login shell<BR>
&gt;<BR>
&gt; &gt;&nbsp; Hi,<BR>
&gt; &gt;&nbsp;&nbsp; Does smpd abort when you run your MPI job ?<BR>
&gt;<BR>
&gt; No.<BR>
&gt;<BR>
&gt; &gt;<BR>
&gt; &gt; Regards,<BR>
&gt; &gt; Jayesh<BR>
&gt; &gt;<BR>
&gt; &gt; -----Original Message-----<BR>
&gt; &gt; From: Yu-Cheng Chou [<A HREF="mailto:cycchou@ucdavis.edu">mailto:cycchou@ucdavis.edu</A>]<BR>
&gt; &gt; Sent: Wednesday, February 04, 2009 1:56 PM<BR>
&gt; &gt; To: Jayesh Krishna<BR>
&gt; &gt; Cc: mpich-discuss@mcs.anl.gov<BR>
&gt; &gt; Subject: Re: [mpich-discuss] mpiexec kills the remote login shell<BR>
&gt; &gt;<BR>
&gt; &gt; Hi<BR>
&gt; &gt;<BR>
&gt; &gt; I can cross-compile the program and then simply run the<BR>
&gt; executable on<BR>
&gt; &gt; Korebot with no errors.<BR>
&gt; &gt;<BR>
&gt; &gt;<BR>
&gt; &gt;&gt; Hi,<BR>
&gt; &gt;&gt;&nbsp; Can you try running (without mpiexec) a simple C program with<BR>
&gt; &gt;&gt; exit(-1) on Korebot ?<BR>
&gt; &gt;&gt;<BR>
&gt; &gt;&gt; ========================================<BR>
&gt; &gt;&gt; #include &lt;stdlib.h&gt;<BR>
&gt; &gt;&gt; int main(int argc, char *argv[])<BR>
&gt; &gt;&gt; {<BR>
&gt; &gt;&gt;&nbsp;&nbsp;&nbsp;&nbsp; exit(-1);<BR>
&gt; &gt;&gt; }<BR>
&gt; &gt;&gt; ========================================<BR>
&gt; &gt;&gt;<BR>
&gt; &gt;&gt; Regards,<BR>
&gt; &gt;&gt; Jayesh<BR>
&gt; &gt;&gt; ________________________________<BR>
&gt; &gt;&gt; From: mpich-discuss-bounces@mcs.anl.gov<BR>
&gt; &gt;&gt; [<A HREF="mailto:mpich-discuss-bounces@mcs.anl.gov">mailto:mpich-discuss-bounces@mcs.anl.gov</A>] On Behalf Of Jayesh<BR>
&gt; &gt;&gt; Krishna<BR>
&gt; &gt;&gt; Sent: Wednesday, February 04, 2009 1:04 PM<BR>
&gt; &gt;&gt; To: 'Yu-Cheng Chou'<BR>
&gt; &gt;&gt; Cc: mpich-discuss@mcs.anl.gov<BR>
&gt; &gt;&gt; Subject: Re: [mpich-discuss] mpiexec kills the remote login shell<BR>
&gt; &gt;&gt;<BR>
&gt; &gt;&gt;&nbsp; Hi,<BR>
&gt; &gt;&gt;&nbsp;&nbsp; Can you also attach the corresponding smpd debug output ?<BR>
&gt; &gt;&gt;<BR>
&gt; &gt;&gt; Regards,<BR>
&gt; &gt;&gt; Jayesh<BR>
&gt; &gt;&gt;<BR>
&gt; &gt;&gt; -----Original Message-----<BR>
&gt; &gt;&gt; From: Yu-Cheng Chou [<A HREF="mailto:cycchou@ucdavis.edu">mailto:cycchou@ucdavis.edu</A>]<BR>
&gt; &gt;&gt; Sent: Wednesday, February 04, 2009 1:02 PM<BR>
&gt; &gt;&gt; To: Jayesh Krishna<BR>
&gt; &gt;&gt; Cc: mpich-discuss@mcs.anl.gov<BR>
&gt; &gt;&gt; Subject: Re: [mpich-discuss] mpiexec kills the remote login shell<BR>
&gt; &gt;&gt;<BR>
&gt; &gt;&gt; Hi,<BR>
&gt; &gt;&gt;<BR>
&gt; &gt;&gt; Firstly, the previously attached mpiexec verbose output is<BR>
&gt; a wrong one.<BR>
&gt; &gt;&gt; I've attached the correct one to this email.<BR>
&gt; &gt;&gt;<BR>
&gt; &gt;&gt; Secondly, I want to point out that as long as mpiexec is initiated<BR>
&gt; &gt;&gt; from Korebot to run a program, no matter it's a MPI or non-MPI<BR>
&gt; &gt;&gt; program, no matter the program can be found or not, as soon as<BR>
&gt; &gt;&gt; mpiexec is finished, the ssh connection to Korebot will be gone.<BR>
&gt; &gt;&gt;<BR>
&gt; &gt;&gt; Thank you<BR>
&gt; &gt;&gt;<BR>
&gt; &gt;&gt;<BR>
&gt; &gt;&gt;&gt; Hi,<BR>
&gt; &gt;&gt;&gt;&nbsp;&nbsp; The mpiexec output shows the following error when<BR>
&gt; running hellow,<BR>
&gt; &gt;&gt;&gt; ==================<BR>
&gt; &gt;&gt;&gt;<BR>
&gt; &gt;&gt;&gt; Unable to exec 'hello' on korebot<BR>
&gt; &gt;&gt;&gt;<BR>
&gt; &gt;&gt;&gt; Error 2 - No such file or directory<BR>
&gt; &gt;&gt;&gt;<BR>
&gt; &gt;&gt;&gt; ==================<BR>
&gt; &gt;&gt;&gt;<BR>
&gt; &gt;&gt;&gt;&nbsp;&nbsp; Please provide the debug output of smpd (smpd -d 2&gt;&amp;1 | tee<BR>
&gt; &gt;&gt;&gt; smpd.out) along with mpiexec (mpiexec -verbose -n 2<BR>
&gt; ./hellow 2&gt;&amp;1 |<BR>
&gt; &gt;&gt;&gt; tee mpiexec.out).<BR>
&gt; &gt;&gt;&gt;<BR>
&gt; &gt;&gt;&gt; #&nbsp; Can you run simple C programs (without using mpiexec)<BR>
&gt; on Korbet ?<BR>
&gt; &gt;&gt;&gt; #&nbsp; Is the ssh connection aborted when you run non-MPI programs<BR>
&gt; &gt;&gt;&gt; (mpiexec -n 2<BR>
&gt; &gt;&gt;&gt; hostname) ?<BR>
&gt; &gt;&gt;&gt; #&nbsp; Can you send us your &quot;.smpd&quot; config file ?<BR>
&gt; &gt;&gt;&gt; #&nbsp; Did you modify the MPICH2 code to run on Korbet<BR>
&gt; (Please send us<BR>
&gt; &gt;&gt;&gt; your configure command &amp; any env settings set to<BR>
&gt; configure/make MPICH2)?<BR>
&gt; &gt;&gt;&gt;<BR>
&gt; &gt;&gt;&gt; Regards,<BR>
&gt; &gt;&gt;&gt; Jayesh<BR>
&gt; &gt;&gt;&gt;<BR>
&gt; &gt;&gt;&gt; ________________________________<BR>
&gt; &gt;&gt;&gt; From: mpich-discuss-bounces@mcs.anl.gov<BR>
&gt; &gt;&gt;&gt; [<A HREF="mailto:mpich-discuss-bounces@mcs.anl.gov">mailto:mpich-discuss-bounces@mcs.anl.gov</A>] On Behalf Of Jayesh<BR>
&gt; &gt;&gt;&gt; Krishna<BR>
&gt; &gt;&gt;&gt; Sent: Wednesday, February 04, 2009 8:41 AM<BR>
&gt; &gt;&gt;&gt; To: 'Yu-Cheng Chou'<BR>
&gt; &gt;&gt;&gt; Cc: mpich-discuss@mcs.anl.gov<BR>
&gt; &gt;&gt;&gt; Subject: Re: [mpich-discuss] mpiexec kills the remote login shell<BR>
&gt; &gt;&gt;&gt;<BR>
&gt; &gt;&gt;&gt;&nbsp; Hi,<BR>
&gt; &gt;&gt;&gt;&nbsp;&nbsp; I will take a look at the debug logs and get back to you.<BR>
&gt; &gt;&gt;&gt; Meanwhile, can you run simple C programs without using mpiexec on<BR>
&gt; &gt;&gt;&gt; Korbet ?<BR>
&gt; &gt;&gt;&gt;&nbsp;&nbsp; MPICH2 currently does not support heterogeneous systems (So you<BR>
&gt; &gt;&gt;&gt; won't be able to run your MPI job across ARM &amp; other<BR>
&gt; architectures).<BR>
&gt; &gt;&gt;&gt;<BR>
&gt; &gt;&gt;&gt; Regards,<BR>
&gt; &gt;&gt;&gt; Jayesh<BR>
&gt; &gt;&gt;&gt;<BR>
&gt; &gt;&gt;&gt; -----Original Message-----<BR>
&gt; &gt;&gt;&gt; From: Yu-Cheng Chou [<A HREF="mailto:cycchou@ucdavis.edu">mailto:cycchou@ucdavis.edu</A>]<BR>
&gt; &gt;&gt;&gt; Sent: Tuesday, February 03, 2009 7:52 PM<BR>
&gt; &gt;&gt;&gt; To: Jayesh Krishna<BR>
&gt; &gt;&gt;&gt; Cc: mpich-discuss@mcs.anl.gov<BR>
&gt; &gt;&gt;&gt; Subject: Re: [mpich-discuss] mpiexec kills the remote login shell<BR>
&gt; &gt;&gt;&gt;<BR>
&gt; &gt;&gt;&gt;&gt; # Can you run non-MPI programs using mpiexec (mpiexec -n<BR>
&gt; 2 hostname) ?<BR>
&gt; &gt;&gt;&gt; Yes.<BR>
&gt; &gt;&gt;&gt;<BR>
&gt; &gt;&gt;&gt;&gt; # Can you compile and run the hello world program<BR>
&gt; &gt;&gt;&gt;&gt; (examples/hellow.c) provided with MPICH2 (mpiexec -n 2 ./hellow)?<BR>
&gt; &gt;&gt;&gt; Yes.<BR>
&gt; &gt;&gt;&gt;<BR>
&gt; &gt;&gt;&gt;&gt; # How did you start smpd (the command used to start<BR>
&gt; smpd) ? How did<BR>
&gt; &gt;&gt;&gt;&gt; you run your MPI job (the command used to run your job)?<BR>
&gt; &gt;&gt;&gt; I have a &quot;.smpd&quot; file containing one line of information,<BR>
&gt; which is<BR>
&gt; &gt;&gt;&gt; &quot;phrase=123&quot;.<BR>
&gt; &gt;&gt;&gt; Thus, I started smpd using &quot;smpd -s&quot;.<BR>
&gt; &gt;&gt;&gt; Then I used &quot;mpiexec -n 1 hellow&quot; to run hellow on Korebot.<BR>
&gt; &gt;&gt;&gt;<BR>
&gt; &gt;&gt;&gt;&gt; # How did you find that mpiexec kills the sshd process (We<BR>
&gt; &gt;&gt;&gt;&gt; typically ssh to unix machines and run mpiexec without<BR>
&gt; any problems) ?<BR>
&gt; &gt;&gt;&gt; I logged in Korebot with two terminals.<BR>
&gt; &gt;&gt;&gt; &gt;From #1 terminal, I checked all the processes running on Korebot.<BR>
&gt; &gt;&gt;&gt; &gt;From #2 terminal, I started smpd and run hellow using<BR>
&gt; the commands<BR>
&gt; &gt;&gt;&gt; mentioned above.<BR>
&gt; &gt;&gt;&gt; After hellow was finished, the connection to Korebot via<BR>
&gt; #2 terminal<BR>
&gt; &gt;&gt;&gt; was closed.<BR>
&gt; &gt;&gt;&gt; &gt;From #1 terminal, I knew that the sshd process<BR>
&gt; associated with #2<BR>
&gt; &gt;&gt;&gt; &gt;terminal<BR>
&gt; &gt;&gt;&gt; was gone.<BR>
&gt; &gt;&gt;&gt;<BR>
&gt; &gt;&gt;&gt;&gt;&nbsp; Can you run smpd/mpiexec in debug mode and provide us with the<BR>
&gt; &gt;&gt;&gt;&gt; outputs (smpd -d / mpiexec -n 2 -verbose hostname) ?<BR>
&gt; &gt;&gt;&gt; The first attached text file is the output from running hellow in<BR>
&gt; &gt;&gt;&gt; mpiexec's verbose mode.<BR>
&gt; &gt;&gt;&gt;<BR>
&gt; &gt;&gt;&gt;<BR>
&gt; &gt;&gt;&gt; There is another issue.<BR>
&gt; &gt;&gt;&gt; This time, I used two machines. One is Korebot as<BR>
&gt; mentioned above,<BR>
&gt; &gt;&gt;&gt; and the other is a laptop running Ubuntu Linux OS.<BR>
&gt; &gt;&gt;&gt; I started smpd with the same &quot;.smpd&quot; file and command as<BR>
&gt; mentioned<BR>
&gt; &gt;&gt;&gt; above both on Korebot and the lap top.<BR>
&gt; &gt;&gt;&gt; There is a machine file called &quot;hostfile&quot; on Korebot. The file<BR>
&gt; &gt;&gt;&gt; contains the following information about the name of the<BR>
&gt; two machines.<BR>
&gt; &gt;&gt;&gt;<BR>
&gt; &gt;&gt;&gt; korebot<BR>
&gt; &gt;&gt;&gt; shrimp<BR>
&gt; &gt;&gt;&gt;<BR>
&gt; &gt;&gt;&gt; Then from Korebot, I ran cpi using the following command.<BR>
&gt; &gt;&gt;&gt;<BR>
&gt; &gt;&gt;&gt; mpiexec -machinefile ./hostfile -verbose -n 2 cpi<BR>
&gt; &gt;&gt;&gt;<BR>
&gt; &gt;&gt;&gt;<BR>
&gt; &gt;&gt;&gt; But the value of pi is a huge number. I think it is related to<BR>
&gt; &gt;&gt;&gt; &quot;double type variables&quot; being transferred between<BR>
&gt; processes running<BR>
&gt; &gt;&gt;&gt; on an ARM-based Linux and a general Linux machines.<BR>
&gt; &gt;&gt;&gt;<BR>
&gt; &gt;&gt;&gt; The second attached text file is the output from running cpi in<BR>
&gt; &gt;&gt;&gt; mpiexec's verbose mode.<BR>
&gt; &gt;&gt;&gt;<BR>
&gt; &gt;&gt;&gt;<BR>
&gt; &gt;&gt;&gt;&gt;<BR>
&gt; &gt;&gt;&gt;&gt; I am cross-compiling mpich2-1.0.8 with smpd for Khepera<BR>
&gt; III mobile<BR>
&gt; &gt;&gt;&gt;&gt; robot.<BR>
&gt; &gt;&gt;&gt;&gt;<BR>
&gt; &gt;&gt;&gt;&gt; This mobile robot has a Korebot board which is an ARM-based<BR>
&gt; &gt;&gt;&gt;&gt; computer with a Linux operating system.<BR>
&gt; &gt;&gt;&gt;&gt;<BR>
&gt; &gt;&gt;&gt;&gt; The cross-compilation was fine.<BR>
&gt; &gt;&gt;&gt;&gt;<BR>
&gt; &gt;&gt;&gt;&gt; Firstly, I logged in to Korebot through ssh.<BR>
&gt; &gt;&gt;&gt;&gt; Secondly, I started smpd.<BR>
&gt; &gt;&gt;&gt;&gt; Thirdly, I ran mpiexec to execute an MPI program (cpi)<BR>
&gt; that comes<BR>
&gt; &gt;&gt;&gt;&gt; with the package.<BR>
&gt; &gt;&gt;&gt;&gt;<BR>
&gt; &gt;&gt;&gt;&gt; The result was correct, but when mpiexec was finished, the ssh<BR>
&gt; &gt;&gt;&gt;&gt; connection to the Korebot was closed.<BR>
&gt; &gt;&gt;&gt;&gt; I found that mpiexec kills the sshd process through which I was<BR>
&gt; &gt;&gt;&gt;&gt; remotely connected to Korebot.<BR>
&gt; &gt;&gt;&gt;&gt;<BR>
&gt; &gt;&gt;&gt;&gt; I've been looking for the cause, but still have not<BR>
&gt; found any clues.<BR>
&gt; &gt;&gt;&gt;&gt;<BR>
&gt; &gt;&gt;&gt;&gt; Could you give me any ideas to solve this problem?<BR>
&gt; &gt;&gt;&gt;&gt;<BR>
&gt; &gt;&gt;&gt;&gt; Thank you,<BR>
&gt; &gt;&gt;&gt;&gt;<BR>
&gt; &gt;&gt;&gt;&gt; Yu-Cheng<BR>
&gt; &gt;&gt;&gt;&gt;<BR>
&gt; &gt;&gt;&gt;<BR>
&gt; &gt;&gt;<BR>
&gt; &gt;<BR>
&gt; </FONT>
</P>

</BODY>
</HTML>