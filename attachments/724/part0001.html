<div>Looking over the MPIR_Scatterv code, it appears that one of the locations that checks for MPI_IN_PLACE checks the wrong buffer.  In 1.0.8, both places check recvbuf, but in the current version, one of them was changed to sendbuf.</div>
<div><br></div><div><div>1.0.8: <a href="https://svn.mcs.anl.gov/repos/mpi/mpich2/tags/release/mpich2-1.0.8p1/src/mpi/coll/scatterv.c">https://svn.mcs.anl.gov/repos/mpi/mpich2/tags/release/mpich2-1.0.8p1/src/mpi/coll/scatterv.c</a></div>
<div>Current: <a href="https://svn.mcs.anl.gov/repos/mpi/mpich2/trunk/src/mpi/coll/scatterv.c">https://svn.mcs.anl.gov/repos/mpi/mpich2/trunk/src/mpi/coll/scatterv.c</a></div></div><div><br></div><div><div><font class="Apple-style-span" face="&#39;courier new&#39;, monospace">diff --git a/mpich2/src/mpi/coll/scatterv.c b/mpich2/src/mpi/coll/scatterv.c</font></div>
<div><font class="Apple-style-span" face="&#39;courier new&#39;, monospace">index 9c06538..955671a 100644</font></div><div><font class="Apple-style-span" face="&#39;courier new&#39;, monospace">--- a/mpich2/src/mpi/coll/scatterv.c</font></div>
<div><font class="Apple-style-span" face="&#39;courier new&#39;, monospace">+++ b/mpich2/src/mpi/coll/scatterv.c</font></div><div><font class="Apple-style-span" face="&#39;courier new&#39;, monospace">@@ -92,9 +92,9 @@ int MPIR_Scatterv (</font></div>
<div><font class="Apple-style-span" face="&#39;courier new&#39;, monospace">         reqs = 0;</font></div><div><font class="Apple-style-span" face="&#39;courier new&#39;, monospace">         for (i = 0; i &lt; comm_size; i++) {</font></div>
<div><font class="Apple-style-span" face="&#39;courier new&#39;, monospace">             if (sendcnts[i]) {</font></div><div><font class="Apple-style-span" face="&#39;courier new&#39;, monospace">                 if ((comm_ptr-&gt;comm_kind == MPID_INTRACOMM) &amp;&amp; (i == rank)) {</font></div>
<div><font class="Apple-style-span" face="&#39;courier new&#39;, monospace">-                    if (sendbuf != MPI_IN_PLACE) {</font></div><div><font class="Apple-style-span" face="&#39;courier new&#39;, monospace">+                    if (recvbuf != MPI_IN_PLACE) {</font></div>
<div><font class="Apple-style-span" face="&#39;courier new&#39;, monospace">                         mpi_errno = MPIR_Localcopy(((char *)sendbuf+displs[rank]*extent), </font></div><div><font class="Apple-style-span" face="&#39;courier new&#39;, monospace">                                                    sendcnts[rank], sendtype, </font></div>
<div><font class="Apple-style-span" face="&#39;courier new&#39;, monospace">                                                    recvbuf, recvcnt, recvtype);</font></div><div><font class="Apple-style-span" face="&#39;courier new&#39;, monospace">                     }</font></div>
</div><div><br></div><div><br></div><div>Thanks,</div><div>Joe Ratterman</div><div><a href="mailto:jratt@us.ibm.com">jratt@us.ibm.com</a></div>
